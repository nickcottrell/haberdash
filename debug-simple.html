<!DOCTYPE html>
<html>
<head>
    <title>Simple Spectra Debug</title>
</head>
<body style="padding: 2rem; font-family: monospace;">
    <h1>Spectra Debug Test</h1>
    <pre id="log" style="background: #f0f0f0; padding: 1rem; border: 1px solid #ccc;"></pre>

    <script>
        const log = document.getElementById('log');
        function addLog(msg) {
            log.textContent += msg + '\n';
            console.log(msg);
        }

        addLog('1. Starting test...');

        // Test 1: Can we fetch from API directly?
        addLog('2. Testing API fetch...');
        fetch('https://zf8klzvd4k.execute-api.us-east-2.amazonaws.com/prod/blend?node_id=haberdash-ui-theme')
            .then(r => {
                addLog('3. API responded with status: ' + r.status);
                return r.json();
            })
            .then(data => {
                addLog('4. API data received:');
                addLog('   - node_id: ' + data.node_id);
                addLog('   - d1 color: ' + data.colors.d1);
                addLog('   - d1 HSL: h=' + data.metadata.primary_anchor.hsl.h + ' s=' + data.metadata.primary_anchor.hsl.s + ' l=' + data.metadata.primary_anchor.hsl.l);
                addLog('5. ✅ API works!');

                // Test 2: Can we load spectra-theme.js?
                addLog('6. Loading spectra-theme.js...');
                const script = document.createElement('script');
                script.src = 'https://d103b89icpzdo3.cloudfront.net/spectra-theme.js';
                script.setAttribute('data-node-id', 'haberdash-ui-theme');
                script.setAttribute('data-api', 'https://zf8klzvd4k.execute-api.us-east-2.amazonaws.com/prod/blend');
                script.setAttribute('data-debug', '');

                script.onload = () => {
                    addLog('7. ✅ spectra-theme.js loaded');
                };

                script.onerror = () => {
                    addLog('7. ❌ spectra-theme.js failed to load');
                };

                document.head.appendChild(script);

                // Wait and check if theme event fires
                window.addEventListener('spectra-theme-loaded', (e) => {
                    addLog('8. ✅ spectra-theme-loaded event fired!');
                    addLog('9. Checking CSS variables...');
                    const root = getComputedStyle(document.documentElement);
                    addLog('   --color-primary: ' + root.getPropertyValue('--color-primary'));
                    addLog('   --border-radius-base: ' + root.getPropertyValue('--border-radius-base'));
                });

                setTimeout(() => {
                    if (!document.documentElement.classList.contains('spectra-theme-loaded')) {
                        addLog('8. ⚠️  spectra-theme-loaded event did NOT fire after 5 seconds');
                    }
                }, 5000);
            })
            .catch(err => {
                addLog('❌ API fetch failed: ' + err.message);
            });
    </script>
</body>
</html>

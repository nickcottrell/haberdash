<!DOCTYPE html>
<html lang="en" data-theme="live">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Haberdash - Color Space Demo</title>

  <!-- Haberdash CSS -->
  <link rel="stylesheet" href="css/haberdash-base.css">
  <link rel="stylesheet" href="css/themes/spectra.css">

  <style>
    body {
      max-width: 1400px;
      margin: 0 auto;
      padding: 2em 1em;
    }

    header {
      margin-bottom: 3em;
      text-align: center;
    }

    header h1 {
      font-size: 2.5em;
      margin-bottom: 0.25em;
    }

    .demo-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2em;
      margin-bottom: 3em;
    }

    @media (max-width: 900px) {
      .demo-grid {
        grid-template-columns: 1fr;
      }
    }

    .colorspace-container {
      background: var(--surface);
      border: 2px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 2em;
      box-shadow: var(--shadow-md);
    }

    .colorspace-container h2 {
      font-size: 1.75em;
      margin-bottom: 0.5em;
      color: var(--text-heading);
    }

    .colorspace-container .description {
      color: var(--text-secondary);
      margin-bottom: 2em;
      padding-bottom: 1.5em;
      border-bottom: 1px solid var(--border);
    }

    .color-preview {
      margin-top: 2em;
      padding: 2em;
      background: var(--surface-light);
      border-radius: var(--radius-md);
      text-align: center;
    }

    .color-preview__swatch {
      width: 100%;
      height: 120px;
      border: 2px solid var(--border);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-sm);
      margin-bottom: 1em;
      transition: background 200ms;
    }

    .color-preview__values {
      font-family: monospace;
      font-size: 0.9em;
      color: var(--text-body);
      line-height: 1.6;
    }

    .info-panel {
      background: var(--surface);
      border: 2px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 2em;
      margin-top: 2em;
    }

    .info-panel h3 {
      margin-bottom: 1em;
      color: var(--text-heading);
    }

    .info-panel pre {
      background: var(--surface-light);
      padding: 1em;
      border-radius: var(--radius-sm);
      overflow-x: auto;
      font-size: 0.875em;
    }
  </style>
</head>
<body>
  <header>
    <h1>üé® Color Space Demo</h1>
    <p style="font-size: 1.25em; color: var(--text-secondary); margin-top: 0.5em;">
      JSON-Configurable Sliders for Any Color Space
    </p>
  </header>

  <div class="demo-grid">
    <!-- RGB Color Space -->
    <div class="colorspace-container">
      <h2>RGB Color Space</h2>
      <p class="description">
        Additive color model using Red, Green, and Blue channels. Each channel ranges from 0-255.
      </p>
      <div id="rgb-colorspace"></div>
      <div class="color-preview">
        <div class="color-preview__swatch" id="rgb-swatch" style="background: rgb(255, 0, 0);"></div>
        <div class="color-preview__values" id="rgb-values">
          RGB: rgb(255, 0, 0)<br>
          HEX: #FF0000
        </div>
      </div>
    </div>

    <!-- HSL Color Space -->
    <div class="colorspace-container">
      <h2>HSL Color Space</h2>
      <p class="description">
        Hue, Saturation, Lightness model. Hue is 0-360¬∞, Saturation and Lightness are 0-100%.
      </p>
      <div id="hsl-colorspace"></div>
      <div class="color-preview">
        <div class="color-preview__swatch" id="hsl-swatch" style="background: hsl(0, 100%, 50%);"></div>
        <div class="color-preview__values" id="hsl-values">
          HSL: hsl(0, 100%, 50%)<br>
          HEX: #FF0000
        </div>
      </div>
    </div>
  </div>

  <!-- Info Panel -->
  <div class="info-panel">
    <h3>How It Works</h3>
    <p style="margin-bottom: 1em; color: var(--text-body);">
      This demo uses the <code>ColorSpaceSlider</code> class which reads JSON configuration files
      to render sliders for any color space. Each color space config defines:
    </p>
    <ul style="margin-bottom: 1.5em; line-height: 1.8; color: var(--text-body);">
      <li><strong>Channels:</strong> ID, name, description, min/max values, and semantic labels</li>
      <li><strong>Value Labels:</strong> Dynamic text that changes based on slider position</li>
      <li><strong>Presets:</strong> Pre-configured color values with visual swatches</li>
    </ul>
    <p style="margin-bottom: 1em; color: var(--text-body);">
      <strong>Example configs:</strong>
    </p>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1em;">
      <div>
        <p style="margin-bottom: 0.5em; font-weight: 600;">RGB Config</p>
        <code style="font-size: 0.875em;">configs/rgb-colorspace.json</code>
      </div>
      <div>
        <p style="margin-bottom: 0.5em; font-weight: 600;">HSL Config</p>
        <code style="font-size: 0.875em;">configs/hsl-colorspace.json</code>
      </div>
    </div>
  </div>

  <footer style="margin-top: 3em; padding-top: 2em; border-top: 2px solid var(--border); text-align: center; color: var(--text-secondary);">
    <p>
      <a href="demo-index.html" style="color: var(--primary); text-decoration: none; font-weight: 600;">‚Üê Back to Demo Index</a>
    </p>
  </footer>

  <!-- Load the ColorSpaceSlider module -->
  <script src="js/colorspace-slider.js"></script>

  <!-- Initialize color spaces with JSON configs -->
  <script>
    // Utility function to convert RGB to hex
    function rgbToHex(r, g, b) {
      const toHex = (n) => {
        const hex = Math.round(n).toString(16).padStart(2, '0').toUpperCase();
        return hex;
      };
      return `#${toHex(r)}${toHex(g)}${toHex(b)}`;
    }

    // Utility function to convert HSL to RGB
    function hslToRgb(h, s, l) {
      s /= 100;
      l /= 100;

      const c = (1 - Math.abs(2 * l - 1)) * s;
      const x = c * (1 - Math.abs((h / 60) % 2 - 1));
      const m = l - c / 2;
      let r = 0, g = 0, b = 0;

      if (0 <= h && h < 60) {
        r = c; g = x; b = 0;
      } else if (60 <= h && h < 120) {
        r = x; g = c; b = 0;
      } else if (120 <= h && h < 180) {
        r = 0; g = c; b = x;
      } else if (180 <= h && h < 240) {
        r = 0; g = x; b = c;
      } else if (240 <= h && h < 300) {
        r = x; g = 0; b = c;
      } else if (300 <= h && h < 360) {
        r = c; g = 0; b = x;
      }

      r = Math.round((r + m) * 255);
      g = Math.round((g + m) * 255);
      b = Math.round((b + m) * 255);

      return { r, g, b };
    }

    // Load and initialize RGB color space
    fetch('configs/rgb-colorspace.json')
      .then(response => response.json())
      .then(config => {
        const rgbSlider = new ColorSpaceSlider('rgb-colorspace', config);

        // Listen for value changes
        document.getElementById('rgb-colorspace').addEventListener('colorspace-change', (e) => {
          const { r, g, b } = e.detail.values;
          const swatch = document.getElementById('rgb-swatch');
          const values = document.getElementById('rgb-values');

          swatch.style.background = `rgb(${r}, ${g}, ${b})`;
          values.innerHTML = `
            RGB: rgb(${r}, ${g}, ${b})<br>
            HEX: ${rgbToHex(r, g, b)}
          `;
        });
      })
      .catch(error => {
        console.error('Failed to load RGB config:', error);
        document.getElementById('rgb-colorspace').innerHTML =
          '<p style="color: var(--error);">Failed to load RGB configuration</p>';
      });

    // Load and initialize HSL color space
    fetch('configs/hsl-colorspace.json')
      .then(response => response.json())
      .then(config => {
        const hslSlider = new ColorSpaceSlider('hsl-colorspace', config);

        // Listen for value changes
        document.getElementById('hsl-colorspace').addEventListener('colorspace-change', (e) => {
          const { h, s, l } = e.detail.values;
          const swatch = document.getElementById('hsl-swatch');
          const values = document.getElementById('hsl-values');

          swatch.style.background = `hsl(${h}, ${s}%, ${l}%)`;

          const rgb = hslToRgb(h, s, l);
          values.innerHTML = `
            HSL: hsl(${h}, ${s}%, ${l}%)<br>
            HEX: ${rgbToHex(rgb.r, rgb.g, rgb.b)}
          `;
        });
      })
      .catch(error => {
        console.error('Failed to load HSL config:', error);
        document.getElementById('hsl-colorspace').innerHTML =
          '<p style="color: var(--error);">Failed to load HSL configuration</p>';
      });
  </script>

  <!-- SPECTRA INTEGRATION -->
  <script src="js/spectra-theme.js" data-node-id="haberdash-ui-theme"></script>
  <script src="js/spectra-bridge.js"></script>
</body>
</html>
